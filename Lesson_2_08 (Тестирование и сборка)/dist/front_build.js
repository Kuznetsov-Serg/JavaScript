(()=>{var t={118:()=>{Vue.component("basket-item",{props:["item"],template:'\n        <tr class="basket-item">\n            <td>{{item.product_name}}</td>\n            <td>{{item.price}} руб.</td>\n            <td>{{item.count}} шт.</td>\n            <td>{{item.price * item.count}} руб.</td>\n            <td>\n                <button class="button_active" :data-id="item.id" v-on:click="addToBasket(item.id)">➕</button>\n                <button class="button_active" :data-id="item.id" v-on:click="reduceFromBasket(item.id)">➖</button>\n                <button class="button_active" :data-id="item.id" v-on:click="delFromBasket(item.id)">❌</button>\n            </td>\n        </tr>\n    ',methods:{addToBasket(t){this.$emit("addToBasket",t),console.log("addToBasket in child id = "+t)},reduceFromBasket(t){this.$emit("reduceFromBasket",t),console.log("reduceFromBasket in child id = "+t)},delFromBasket(t){this.$emit("delFromBasket",t),console.log("delFromBasket in child id = "+t)}}})},761:()=>{Vue.component("basket-list",{props:["basket"],template:'\n        <div class="basket-list">\n            <h1>Корзина</h1>\n            <p v-if="basket.length < 1">Нет данных</p> \n            <table v-else class="basket-item">\n                <thead>\n                    <tr>\n                        <td class="table_head">Наименование</td>\n                        <td class="table_head">Цена</td>\n                        <td class="table_head">Количество</td>\n                        <td class="table_head">Сумма</td>\n                        <td class="table_head"></td>\n                    </tr>\n                </thead>   \n                <tbody>\n                    <basket-item v-for="item in basket" :item="item" \n                        v-on:addToBasket="addToBasket" \n                        v-on:reduceFromBasket="reduceFromBasket" \n                        v-on:delFromBasket="delFromBasket"\n                        ></basket-item>    \n                </tbody>\n                <tfoot>\n                    <tr>\n                        <td class="table_foot">Итого</td>\n                        <td class="table_foot"></td>\n                        <td class="table_foot">{{getCountTotal}} шт.</td>\n                        <td class="table_foot">{{getPriceTotal}} руб.</td>\n                        <td class="table_foot"></td>\n                    </tr>\n                </tfoot>\n            </table>\n        </div>\n    ',methods:{addToBasket(t){console.log("addToBasket in basket-list id= "+t),this.$emit("change_basket","add",t)},reduceFromBasket(t){console.log("reduceFromBasket in basket-list id="+t),this.$emit("change_basket","reduce",t)},delFromBasket(t){console.log("delFromBasket in basket-list id="+t),this.$emit("change_basket","del",t)}},computed:{getPriceTotal(){return this.basket.reduce((function(t,e){return t+e.price*e.count}),0)},getCountTotal(){return this.basket.reduce((function(t,e){return t+e.count}),0)},getPositionTotal(){return this.basket.length},isBasketEmpty(){return!this.basket.length},upperCaseName(){return this.name.toUpperCase()}}})},595:()=>{Vue.component("goods-item",{props:["good"],template:'\n        <tr class="goods-item">\n            <td>{{good.product_name}}</td>\n            <td>{{good.price}} руб.</td>\n            <td><button class="button_active" :data-id="good.id" @click="addToBasket(good.id)">в корзину</button></td>\n        </tr>  \n    ',methods:{addToBasket(t){console.log("addToBasket in goods-item id = "+t),this.$emit("addToBasket",t)}}})},173:()=>{Vue.component("goods-list",{props:["goods","basket"],template:'\n        <div class="goods-list">\n            <h1>Каталог</h1>\n            <p v-if="goods.length < 1">Нет данных</p> \n            <table v-else class="goods-item">\n                <thead>\n                    <tr>\n                        <td class="table_head">Наименование</td>\n                        <td class="table_head">Цена</td>\n                        <td class="table_head"></td>\n                    </tr>\n                </thead>\n                <tbody>\n                    <goods-item v-for="good in goods" :good="good" v-on:addToBasket="addToBasket"></goods-item>     \x3c!-- передадим в Child элемент "товар" --\x3e\n                </tbody>\n            </table>\n        </div>\n    ',methods:{addToBasket(t){console.log("addToBasket in goods-list id= "+t),this.$emit("change_basket","add",t)}}})},414:()=>{Vue.component("vue-error",{props:["flag_error","error_description"],template:'\n        <div v-if="flag_error" class="error">\n            <h1>Ошибка!</h1>\n            <p>{{error_description}}</p>\n            <button class="button_active" v-on:click=closeError>❌ Закрыть</button>\n        </div>\n    ',methods:{closeError(){console.log("Закрыть ошибку"),this.$emit("clear_error")}}})},154:()=>{Vue.component("vue-search",{props:["goods","filtered_goods"],data:()=>({searchLine:""}),template:'\n        <div>\n        <input type="text" v-model="searchLine" class="goods-search" v-on:input="show($event.target.value)"/>\n        <button class="search-button" type="button" v-on:click=filterGoods>Искать</button>\n        </div>\n    ',methods:{show(t){console.log(t),this.searchLine=t},filterGoods(){console.log("Child вызывает filterGoods searchLine = "+this.searchLine),this.$emit("filter_goods",this.searchLine)}}})}},e={};function o(s){var n=e[s];if(void 0!==n)return n.exports;var d=e[s]={exports:{}};return t[s](d,d.exports,o),d.exports}o.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},o.d=(t,e)=>{for(var s in e)o.o(e,s)&&!o.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";o(154),o(414),o(173),o(595),o(761),o(118);const t=[{id:1,product_name:"Ноутбук крутой",price:150},{id:2,product_name:"Monitor",price:250},{id:3,product_name:"Мышка отличная",price:350},{id:4,product_name:"KeyBoard",price:400}],e=async(t,e)=>await fetch(t,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}),s=async()=>await fetch("/basket").then((t=>t.json()));new Vue({el:"#app",data:{goods:[],filteredGoods:[],basket:[],searchLine:"",isVisibleCart:!0,flagError:!1,errorDescription:""},methods:{sendError(t){this.errorDescription=t,this.flagError=!0,console.log("sendError "+t)},filter_goods(t){console.log("вызов из Child родительского filter_goods "+t),this.filteredGoods=t?this.goods.filter((e=>e.product_name.toLowerCase().includes(t.toLowerCase()))):this.goods,0==this.filteredGoods.length&&(this.sendError("При фильтрации, список товаров пуст!!!"),console.log(this.errorDescription))},changeVisibleBasket(){this.isVisibleCart?this.isVisibleCart=!1:this.isVisibleCart=!0},clear_error(){this.flagError=!1,this.errorDescription=""},change_basket(t,o){console.log(`typeOp = ${t} in main id= ${o}`);const n=this.goods.find((t=>o===t.id));"add"==t?e("/addToBasket",n).then((t=>s())).then((t=>this.basket=t)):"reduce"==t?e("/reduceFromBasket",n).then((t=>s())).then((t=>this.basket=t)):"del"==t&&e("/delFromBasket",n).then((t=>s())).then((t=>this.basket=t))}},mounted:async function(){return await fetch("/catalog").then((t=>t.json())).then((t=>(t.length<4&&this.sendError("С сервера получен список менее 4-х элементов!!! (мы дополним...)"),t))).then((e=>this.goods=[...e,...t])).then((t=>this.filteredGoods=t))},beforeMount:async function(){return await fetch("/basket").then((t=>t.json())).then((t=>this.basket=t))}})})()})();